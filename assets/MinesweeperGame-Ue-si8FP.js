import{g as u,q as j,h as M,l as D,m as L,c as r,b as t,F as y,d as S,t as c,s as q,o,p as x,v as E}from"./index-DvG0paEY.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"game-container"},P={class:"game-header"},U={class:"difficulty-selector"},V=["onClick"],H={class:"game-status"},J={class:"status-box"},K={class:"value"},Q={class:"status-box"},W={class:"value"},X={class:"board-wrapper"},Y=["onClick","onContextmenu"],Z={__name:"MinesweeperGame",setup(ee){const i=u("easy"),a=u([]),v=u("ready"),f=u(0),g=u(0);let m=null;const d={easy:{rows:9,cols:9,mines:10,label:"初级"},medium:{rows:16,cols:16,mines:40,label:"中级"},hard:{rows:30,cols:30,mines:99,label:"高级"}},F=e=>{const s=d[e];return`${s.label} (${s.rows}×${s.cols})`},R=()=>{switch(v.value){case"won":return"😎";case"lost":return"😵";default:return"🙂"}};j(i,()=>{p()});const w=e=>{v.value==="playing"?confirm("当前游戏尚未结束，确定要开始新游戏吗？")&&(i.value=e):i.value=e},$=M(()=>{const{cols:e}=d[i.value];return{gridTemplateColumns:`repeat(${e}, 40px)`}}),k=M(()=>{const e=Math.floor(f.value/60),s=f.value%60;return`${e.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`}),p=()=>{const{rows:e,cols:s,mines:l}=d[i.value];a.value=Array(e).fill().map(()=>Array(s).fill().map(()=>({isMine:!1,isRevealed:!1,isFlagged:!1,neighborMines:0}))),v.value="ready",f.value=0,g.value=l,clearInterval(m)},z=(e,s)=>{if(!(a.value[e][s].isRevealed||a.value[e][s].isFlagged)){if(gameStarted.value||(gameStarted.value=!0,ensureSafeStart(e,s),startTimer()),a.value[e][s].isMine){C(),b(!1);return}a.value[e][s].isRevealed=!0,a.value[e][s].adjacentMines===0&&revealAdjacentCells(e,s),A()}},C=()=>{for(let e=0;e<a.value.length;e++)for(let s=0;s<a.value[e].length;s++)a.value[e][s].isMine&&(a.value[e][s].isRevealed=!0)},b=(e=!1)=>{isPlaying.value=!1,clearInterval(m);const s=gameCanvas.value.getContext("2d");s.fillStyle="rgba(0, 0, 0, 0.5)",s.fillRect(0,0,canvasSize,canvasSize),s.fillStyle="white",s.font="30px Arial",s.textAlign="center",s.fillText(e?"恭喜获胜!":"游戏结束!",canvasSize/2,canvasSize/2),e||(C(),drawBoard())},A=()=>{for(let e=0;e<a.value.length;e++)for(let s=0;s<a.value[e].length;s++){const l=a.value[e][s];if(!l.isMine&&!l.isRevealed)return}b(!0)},I=(e,s)=>{if(v.value!=="playing")return;const l=a.value[e][s];l.isRevealed||(l.isFlagged=!l.isFlagged,g.value+=l.isFlagged?-1:1)},B=e=>({revealed:e.isRevealed,mine:e.isRevealed&&e.isMine,flagged:e.isFlagged}),G=e=>e.isFlagged?"🚩":e.isRevealed?e.isMine?"💣":e.neighborMines||"":"";return D(()=>{p()}),L(()=>{clearInterval(m)}),(e,s)=>(o(),r("div",O,[t("div",P,[s[2]||(s[2]=t("h2",null,"扫雷",-1)),t("div",U,[(o(),r(y,null,S(d,(l,n)=>t("button",{key:n,class:x({active:i.value===n}),onClick:_=>w(n)},c(F(n)),11,V)),64))]),t("div",H,[t("div",J,[s[0]||(s[0]=t("span",{class:"icon"},"💣",-1)),t("span",K,c(g.value),1)]),t("button",{class:"restart-btn",onClick:p},c(R()),1),t("div",Q,[s[1]||(s[1]=t("span",{class:"icon"},"⏱️",-1)),t("span",W,c(k.value),1)])])]),t("div",X,[t("div",{class:"minesweeper-board",style:q($.value)},[(o(!0),r(y,null,S(a.value,(l,n)=>(o(),r("div",{key:n,class:"row"},[(o(!0),r(y,null,S(l,(_,h)=>(o(),r("div",{key:h,class:x(["cell",B(_)]),onClick:T=>z(n,h),onContextmenu:E(T=>I(n,h),["prevent"])},c(G(_)),43,Y))),128))]))),128))],4)])]))}},te=N(Z,[["__scopeId","data-v-8579a4fa"]]);export{te as default};
