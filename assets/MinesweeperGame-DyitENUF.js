import{g as h,q as U,h as $,l as W,m as H,c as p,b as a,F,d as S,t as f,s as J,v as K,o as _,p as I,x as O}from"./index-BSz8bTJC.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"game-container"},Y={class:"game-header"},Z={class:"difficulty-selector"},ee=["onClick"],se={class:"game-status"},te={class:"status-box"},ae={class:"value"},le={class:"status-box"},ne={class:"value"},oe={class:"board-wrapper"},ie=["onClick","onContextmenu"],re={key:0,class:"game-over-modal"},ce={class:"modal-content"},ue={class:"modal-icon"},ve={__name:"MinesweeperGame",setup(de){const u=h("easy"),o=h([]),n=h("ready"),w=h(0),b=h(0);let m=null;const g={easy:{rows:9,cols:9,mines:10,label:"初级"},medium:{rows:16,cols:16,mines:40,label:"中级"},hard:{rows:30,cols:30,mines:99,label:"高级"}},A=e=>{const s=g[e];return`${s.label} (${s.rows}×${s.cols})`},G=()=>{switch(n.value){case"won":return"😎";case"lost":return"😵";default:return"🙂"}};U(u,()=>{M()});const T=e=>{n.value==="playing"?confirm("当前游戏尚未结束，确定要开始新游戏吗？")&&(u.value=e):u.value=e},j=$(()=>{const{cols:e}=g[u.value];return{gridTemplateColumns:`repeat(${e}, 40px)`}}),k=$(()=>{const e=Math.floor(w.value/60),s=w.value%60;return`${e.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`}),M=()=>{const{rows:e,cols:s,mines:t}=g[u.value];o.value=Array(e).fill().map(()=>Array(s).fill().map(()=>({isMine:!1,isRevealed:!1,isFlagged:!1,neighborMines:0}))),n.value="ready",w.value=0,b.value=t,clearInterval(m)},B=(e,s)=>{const{rows:t,cols:l,mines:i}=g[u.value];let c=i;for(;c>0;){const r=Math.floor(Math.random()*t),v=Math.floor(Math.random()*l);if(!o.value[r][v].isMine&&(r!==e||v!==s)){o.value[r][v].isMine=!0,c--;for(let d=-1;d<=1;d++)for(let y=-1;y<=1;y++){const C=r+d,R=v+y;C>=0&&C<t&&R>=0&&R<l&&o.value[C][R].neighborMines++}}}};h(!1);const z=()=>{m&&clearInterval(m),w.value=0,m=setInterval(()=>{w.value++},1e3)},D=(e,s)=>{n.value="playing",B(e,s),z()},x=(e,s)=>{const{rows:t,cols:l}=g[u.value];for(let i=-1;i<=1;i++)for(let c=-1;c<=1;c++){const r=e+i,v=s+c;if(r>=0&&r<t&&v>=0&&v<l){const d=o.value[r][v];!d.isRevealed&&!d.isFlagged&&(d.isRevealed=!0,d.neighborMines===0&&x(r,v))}}},L=(e,s)=>{const t=o.value[e][s];if(!(t.isRevealed||t.isFlagged||n.value!=="ready"&&n.value!=="playing")){if(n.value==="ready"&&D(e,s),t.isMine){t.isRevealed=!0,n.value="lost",N(),clearInterval(m);return}t.isRevealed=!0,t.neighborMines===0&&x(e,s),V()}},N=()=>{for(let e=0;e<o.value.length;e++)for(let s=0;s<o.value[e].length;s++)o.value[e][s].isMine&&(o.value[e][s].isRevealed=!0)},V=()=>{const{rows:e,cols:s}=g[u.value];for(let t=0;t<e;t++)for(let l=0;l<s;l++){const i=o.value[t][l];if(!i.isMine&&!i.isRevealed)return}n.value="won",clearInterval(m)},q=(e,s)=>{if(n.value!=="playing")return;const t=o.value[e][s];t.isRevealed||(t.isFlagged=!t.isFlagged,b.value+=t.isFlagged?-1:1)},E=e=>({revealed:e.isRevealed,mine:e.isRevealed&&e.isMine,flagged:e.isFlagged}),P=e=>e.isFlagged?"🚩":e.isRevealed?e.isMine?"💣":e.neighborMines||"":"";return W(()=>{M()}),H(()=>{clearInterval(m)}),(e,s)=>(_(),p("div",X,[a("div",Y,[s[2]||(s[2]=a("h2",null,"扫雷",-1)),a("div",Z,[(_(),p(F,null,S(g,(t,l)=>a("button",{key:l,class:I({active:u.value===l}),onClick:i=>T(l)},f(A(l)),11,ee)),64))]),a("div",se,[a("div",te,[s[0]||(s[0]=a("span",{class:"icon"},"💣",-1)),a("span",ae,f(b.value),1)]),a("button",{class:"restart-btn",onClick:M},f(G()),1),a("div",le,[s[1]||(s[1]=a("span",{class:"icon"},"⏱️",-1)),a("span",ne,f(k.value),1)])])]),a("div",oe,[a("div",{class:"minesweeper-board",style:J(j.value)},[(_(!0),p(F,null,S(o.value,(t,l)=>(_(),p("div",{key:l,class:"row"},[(_(!0),p(F,null,S(t,(i,c)=>(_(),p("div",{key:c,class:I(["cell",E(i)]),onClick:r=>L(l,c),onContextmenu:O(r=>q(l,c),["prevent"])},f(P(i)),43,ie))),128))]))),128))],4)]),n.value==="lost"||n.value==="won"?(_(),p("div",re,[a("div",ce,[a("div",ue,f(n.value==="won"?"🎉":"💥"),1),a("h2",null,f(n.value==="won"?"恭喜获胜!":"游戏结束!"),1),a("p",null,"用时: "+f(k.value),1),a("button",{class:"restart-btn",onClick:M},"重新开始")])])):K("",!0)]))}},ge=Q(ve,[["__scopeId","data-v-e5e79f74"]]);export{ge as default};
